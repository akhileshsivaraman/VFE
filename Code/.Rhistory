##### geomorph #####
setwd("~/Documents/Imperial/UEBS/Lab 2 example/")
library(geomorph) # mac users will need to download XQuartz
##### geomorph #####
setwd("~/Documents/Imperial/UEBS/geomorph/")
#### Adams & Otarola-Castillo, 2013 ####
data("plethodon")
# plot original landmark data
plotAllSpecimens(plethodon$land)
# Procrustes superimposition and plot the aligned landmarks
Y.gpa <- gpagen(plethodon$land) # gpa alignment
plotAllSpecimens(Y.gpa$coords, links = plethodon$links)
# 3D data with semilandmarks
data("scallops")
View(plethodon)
View(Y.gpa)
Y.gpa2 <- gpagen(A = scallops$coorddata, # object containing landmark coordinates
curves = scallops$curvslide, # landmarks to be treated as semilandmarks on boundary curves
surfaces = scallops$surfslide # landmarks to be treated as semilandmarks on surfaces
)
View(Y.gpa2)
View(scallops)
View(plethodon)
plotAllSpecimens(Y.gpa2$coords) # 3D plot
# principal coordinate analysis
# plotTangentSpace() removed from geomorph
# gm.prcomp, summary.prcomp, plot.gm.prcomp and picknplot.shape are now used
pca <- gm.prcomp(Y.gpa$coords)
plot(pca$center) # not sure which one is the correct list
View(pca)
plot(pca$d)
plot(pca$sdev)
plot(pca$center) # not sure which one is the correct list
View(pca)
pca[["x"]]
pc1 <- pca$x
pc1 <- as.data.frame(pca$x)
View(pc1)
pc <- as.data.frame(pca$x)
plot(pc$Comp1,
pc$Comp2)
# in this data set specimens represent two species in two distinct environments
# we can use MANOVA to identify sig differences
y <- two.d.arrayay(Y.gpa$coords) # convert a 3D array into a 2D matrix
# in this data set specimens represent two species in two distinct environments
# we can use MANOVA to identify sig differences
y <- two.d.array(Y.gpa$coords) # convert a 3D array into a 2D matrix
lm <- procD.lm(y~plethodon$species*plethodon$site, iter=99)
# visualise mean shape difference between groups
# obtain average landmark coordinates for each group and the overall mean
# plot differences as thin plate spline transformation grids
ref <- mshape(Y.gpa$coords)
gp1.mn <- mshape(Y.gpa$coords[,,1:20])
plotRefToTarget(ref, gp1.mn, mag = 2,
links = plethodon$links)
# multivariate patterns of allometry can also be visualised
ratgpa <- gpagen(ratland)
plotAllometry(ratgpa$coords, ratgpa$Csize, method = "CAC")
# multivariate regression
ratlm <- procD.lm(two.d.array(ratgpa$coords)~ratgpa$Csize, iter = 999)
# combining phylogenetic data with shape data to estimate the degree of phylogenetic signal in shape
# view of the shape space with the phylogeny superimposed
data("plethspecies")
plethgpa <- gpagen(plethspecies$land)
a <- physignal(A = plethgpa$coords,
phy = plethspecies$phy,
iter = 99)
a$phy.signal
a$pvalue
plot(a$PaCA$phy)
##### geomorph #####
setwd("~/Documents/Imperial/UEBS/geomorph/")
library(geomorph) # mac users will need to download XQuartz
