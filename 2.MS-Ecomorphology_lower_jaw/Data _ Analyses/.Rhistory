library(phytools)
data("anoletree")
View(anoletree)
plotTree(anoletree)
svl <- read.csv("http://www.phytools.org/eqg2015/data/svl.csv", row.names = T)
svl <- read.csv("http://www.phytools.org/eqg2015/data/svl.csv", row.names = 1)
View(svl)
svl <- as.matrix(svl)[,1]
names(svl)
# estimate ancestral states
fit <- fastAnc(anoletree, svl, vars = T, CI = T)
tree <- geiger::treedata(anoletree, svl)
# estimate ancestral states
fit <- fastAnc(anoletree, svl, vars = T, CI = T)
# estimate ancestral states
svl1 <- svl[1:82]
fit <- fastAnc(anoletree, svl1, vars = T, CI = T)
library(ape)
library(phytools)
install.packages("diversitree")
library(diversitree)
data("anoletree")
x <- getStates(anoletree, "tips")
View(anoletree)
anoletree[["maps"]]
anoletree[["node.states"]]
x
rmtree(anoletree)
tree <- anoletree
rm(anoletree)
tree
plot(tree,
type = "fan")
plot(tree,
type = "fan", fsize = 0.8)
plot(tree,
type = "fan", fsize = 0.8, ftype = "i")
plot(tree, type = "fan", fsize = 0.8, ftype = "i")
par(mar=c(0,0,0,0))
plot(tree, type = "fan", fsize = 0.8, ftype = "i")
plot.phylo(tree, "cladogram")
plot.phylo(tree, "phylogram")
plotTree(tree, type = "fan", fsize = 0.8, ftype = i)
plotTree(tree, type = "fan", fsize = 0.8, ftype = "i")
plotTree(tree)
plotTree(tree, type = "fan", fsize = 1, ftype = "i")
plotTree(tree)
cols <- setNames(palette()[1:length(unique(x))], sort(unique(x)))
tiplabels(pie = to.matrix(x, sort(unique(x))), piecol = cols, cex=0.3)
plot.phylo(tree, offset = 0.2)
plot.phylo(tree, label.offset = 0.4)
plot.phylo(tree, label.offset = 0.4)
cols <- setNames(palette()[1:length(unique(x))], sort(unique(x)))
tiplabels(pie = to.matrix(x, sort(unique(x))), piecol = cols, cex=0.3)
plot.phylo(tree, label.offset = 0.4, cex = 0.8)
cols <- setNames(palette()[1:length(unique(x))], sort(unique(x)))
tiplabels(pie = to.matrix(x, sort(unique(x))), piecol = cols, cex=0.3)
add.simmap.legend(colors = cols, prompt = F,
x = 0.9*par()$usr[1],
y = -max(nodeHeights(tree)), fsize = 0.8)
add.simmap.legend(colors = cols)
fitER <- ace(x, tree, model = "ER", type = "discrete")
fitER
round(fitER$lik.anc, 3)
plot.phylo(tree, label.offset = 0.4, cex = 0.8)
nodelabels(node = 1:tree$Nnode+Ntip(tree),
pie = fitER$lik.anc, piecol = cols, cex = 0.5)
tiplabels(pie = to.matrix(x, sort(unique(x))), piecol = cols, cex = 0.3)
par(mfrow = c(1,1))
plot.phylo(tree, label.offset = 0.4, cex = 0.8)
par(mfrow = c(0,1))
par(mfrow = c(1,1))
plot.phylo(tree, label.offset = 0.4, cex = 0.8)
nodelabels(node = 1:tree$Nnode+Ntip(tree),
pie = fitER$lik.anc, piecol = cols, cex = 0.5)
tiplabels(pie = to.matrix(x, sort(unique(x))), piecol = cols, cex = 0.3)
plot.phylo(tree, label.offset = 0.4, cex = 0.8, type = "cladogram")
plot.phylo(tree, label.offset = 0.4, cex = 0.8, type = "cladogram", use.edge.length = F)
nodelabels(node = 1:tree$Nnode+Ntip(tree),
pie = fitER$lik.anc, piecol = cols, cex = 0.5)
tiplabels(pie = to.matrix(x, sort(unique(x))), piecol = cols, cex = 0.3)
par(mfcol = c(1,1))
plot.phylo(tree, label.offset = 0.4, cex = 0.8, type = "cladogram", use.edge.length = F)
nodelabels(node = 1:tree$Nnode+Ntip(tree),
pie = fitER$lik.anc, piecol = cols, cex = 0.5)
tiplabels(pie = to.matrix(x, sort(unique(x))), piecol = cols, cex = 0.3)
# MCMC model
mtree <- make.simmap(tree, x, model = "ER")
plot.phylo(mtree, type = "radial")
plot.phylo(mtree, type = "phylogram")
plot.phylo(mtree, type = "phylogram", cols)
plot.phylo(mtree, edge.color = cols, type = "phylogram")
mtrees <- make.simmap(tree, x, model = "ER", nsim = 100)
par(mfrow = c(10,10))
null <- sapply(mtrees, plot, colours = cols)
null <- sapply(mtrees, plot, col = cols)
pd <- summary(mtrees, plot = F)
pd
plot(pd, fsize = 0.6, ftype = "i")
par(mfrow = c(1,1))
pd <- summary(mtrees, plot = F)
plot(pd, fsize = 0.6, ftype = "i")
plot(mtrees[[1]], col = cols)
nodelabels(pie = pd$ace, piecol = cols, cex = 0.5)
library(phytools)
source("sim.history.R")
library(ape)
tree <- rbdtree(b=1, d=0, Tmax = log(12.5))
q <- matrix(c(-1,1,1,-1),2,2)
View(q)
View(tree)
mtree <- sim.history(tree, q)
plotSimmap(mtree)
View(mtree)
View(tree)
View(mtree)
install.packages("BAMMtools")
setwd("~/Documents/Imperial/UEBS/2.MS-Ecomorphology_lower_jaw/Data _ Analyses")
library(BAMMtools)
library(ape)
library(geiger)
tree <- read.nexus("Adam_ML_SharkTree.nex.txt")
data <- read.table("N=153 spp PC1 dietcode MCL averaged by spp NA diet pruned.txt")
View(data)
data <- read.table("N=153 spp PC1 dietcode MCL averaged by spp NA diet pruned.txt", header = T, row.names = 1)
View(data)
newtree <- treedata(tree, data)
View(data)
a <- BAMMlikelihood(newtree$phy, eventdata = newtree$data[,2])
a <- BAMMlikelihood(newtree$phy, eventdata = newtree$data[,3])
